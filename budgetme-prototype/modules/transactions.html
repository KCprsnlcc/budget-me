<!-- Transactions Module Content -->
<style>
    /* ========================================
   Transaction Modals — Premium Monochromatic System
   ======================================== */

    /* Transaction Stepper System */
    .txn-stepper {
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 14px 20px 10px;
        background: white;
        border-bottom: 1px solid #e2e8f0;
    }

    .txn-step-wrap {
        display: flex;
        flex-direction: column;
        align-items: center;
    }

    .txn-step-dot {
        width: 26px;
        height: 26px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 10px;
        font-weight: 600;
        border: 1.5px solid #cbd5e1;
        color: #94a3b8;
        background: white;
        transition: all 300ms cubic-bezier(.4, 0, .2, 1);
        position: relative;
        z-index: 2;
        flex-shrink: 0;
    }

    .txn-step-dot.active {
        border-color: #10b981;
        color: white;
        background: #10b981;
        box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.1);
    }

    .txn-step-dot.completed {
        border-color: #10b981;
        color: white;
        background: #10b981;
    }

    .txn-step-label {
        font-size: 9px;
        font-weight: 600;
        color: #94a3b8;
        margin-top: 4px;
        text-align: center;
        transition: color 200ms;
        text-transform: uppercase;
        letter-spacing: 0.05em;
    }

    .txn-step-label.active {
        color: #10b981;
    }

    .txn-step-label.completed {
        color: #475569;
    }

    .txn-step-connector {
        width: 36px;
        height: 1.5px;
        background: #e2e8f0;
        margin: 0 6px;
        margin-bottom: 18px;
        transition: background 300ms;
        flex-shrink: 0;
    }

    .txn-step-connector.completed {
        background: #10b981;
    }

    /* Transaction Selection Cards */
    .txn-card {
        position: relative;
        padding: 16px;
        border-radius: 12px;
        border: 1px solid #e2e8f0;
        cursor: pointer;
        transition: all 200ms ease;
        background: white;
    }

    .txn-card:hover {
        border-color: #cbd5e1;
        box-shadow: 0 4px 16px rgba(0, 0, 0, 0.04);
    }

    .txn-card.selected {
        border-color: #10b981;
        box-shadow: 0 0 0 1px #10b981;
    }

    .txn-card .txn-check {
        position: absolute;
        top: 12px;
        right: 12px;
        width: 18px;
        height: 18px;
        border-radius: 50%;
        background: #10b981;
        color: white;
        display: flex;
        align-items: center;
        justify-content: center;
        opacity: 0;
        transform: scale(0.5);
        transition: all 200ms;
    }

    .txn-card.selected .txn-check {
        opacity: 1;
        transform: scale(1);
    }

    /* Transaction Type Selector */
    .txn-type-btn {
        flex: 1;
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 8px;
        padding: 14px 12px;
        border-radius: 10px;
        border: 1.5px solid #e2e8f0;
        background: white;
        cursor: pointer;
        transition: all 200ms ease;
        color: #64748b;
    }

    .txn-type-btn:hover {
        border-color: #cbd5e1;
        background: #f8fafc;
        color: #475569;
    }

    .txn-type-btn.active {
        border-color: #10b981;
        background: #10b981;
        color: white;
        box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.1);
    }

    /* Transaction Form Inputs */
    .txn-input {
        width: 100%;
        padding: 10px 14px;
        font-size: 13px;
        color: #1e293b;
        background: white;
        border: 1px solid #e2e8f0;
        border-radius: 8px;
        transition: all 200ms;
        font-family: 'Inter', sans-serif;
    }

    .txn-input:hover {
        border-color: #cbd5e1;
    }

    .txn-input:focus {
        outline: none;
        border-color: #10b981;
        box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.06);
    }

    .txn-input::placeholder {
        color: #94a3b8;
    }

    .txn-label {
        display: block;
        font-size: 11px;
        font-weight: 600;
        color: #334155;
        margin-bottom: 6px;
        text-transform: uppercase;
        letter-spacing: 0.04em;
    }

    /* Transaction Review Card */
    .txn-review {
        background: white;
        border: 1px solid #e2e8f0;
        border-radius: 12px;
        overflow: hidden;
    }

    .txn-review-head {
        display: flex;
        align-items: center;
        gap: 14px;
        padding: 20px;
        border-bottom: 1px solid #f1f5f9;
    }

    .txn-review-body {
        padding: 20px;
    }

    .txn-review-row {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 10px 0;
    }

    .txn-review-row:not(:last-child) {
        border-bottom: 1px solid #f1f5f9;
    }

    /* Transaction Icon */
    .txn-icon {
        width: 40px;
        height: 40px;
        border-radius: 10px;
        display: flex;
        align-items: center;
        justify-content: center;
        background: #f8fafc;
        color: #94a3b8;
        flex-shrink: 0;
        border: 1px solid #f1f5f9;
        transition: all 200ms;
    }

    .txn-card:hover .txn-icon {
        color: #64748b;
    }

    .txn-card.selected .txn-icon {
        background: #f1f5f9;
        color: #334155;
    }

    /* Transaction Notice */
    .txn-notice {
        display: flex;
        gap: 10px;
        padding: 12px 14px;
        border-radius: 8px;
        font-size: 12px;
        line-height: 1.6;
        align-items: flex-start;
        background: #f8fafc;
        border: 1px solid #e2e8f0;
        color: #475569;
    }

    .txn-notice.warn {
        background: #fffbeb;
        border-color: #fef3c7;
        color: #92400e;
    }

    .txn-notice.success {
        background: #f0fdf4;
        border-color: #dcfce7;
        color: #166534;
    }

    /* Transaction Amount Display */
    .txn-amount-display {
        text-align: center;
        padding: 24px;
        background: #f8fafc;
        border-radius: 12px;
        border: 1px solid #e2e8f0;
    }

    .txn-amount-value {
        font-size: 32px;
        font-weight: 700;
        color: #1e293b;
        margin: 8px 0;
    }

    .txn-amount-value.income {
        color: #10b981;
    }

    .txn-amount-value.expense {
        color: #ef4444;
    }

    /* Transaction Tabs */
    .txn-tabs {
        display: flex;
        border-bottom: 1px solid #e2e8f0;
        background: white;
    }

    .txn-tab {
        padding: 12px 20px;
        font-size: 12px;
        font-weight: 600;
        color: #64748b;
        cursor: pointer;
        transition: all 200ms;
        border-bottom: 2px solid transparent;
        margin-bottom: -1px;
    }

    .txn-tab:hover {
        color: #475569;
        background: #f8fafc;
    }

    .txn-tab.active {
        color: #10b981;
        border-bottom-color: #10b981;
        background: white;
    }

    /* Transaction Micro-animations */
    .txn-enter {
        animation: txnIn 300ms cubic-bezier(.4, 0, .2, 1) both;
    }

    @keyframes txnIn {
        from {
            opacity: 0;
            transform: translateY(8px);
        }

        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    .txn-stagger>*:nth-child(1) {
        animation-delay: 40ms;
    }

    .txn-stagger>*:nth-child(2) {
        animation-delay: 100ms;
    }

    .txn-stagger>*:nth-child(3) {
        animation-delay: 160ms;
    }

    .txn-stagger>*:nth-child(4) {
        animation-delay: 220ms;
    }

    .txn-stagger>*:nth-child(5) {
        animation-delay: 280ms;
    }

    .txn-stagger>*:nth-child(6) {
        animation-delay: 340ms;
    }

    .txn-stagger>* {
        opacity: 0;
        animation: txnIn 300ms cubic-bezier(.4, 0, .2, 1) both;
    }

    /* Modal overrides for transaction modals */
    #addTransactionModal .modal,
    #editTransactionModal .modal,
    #viewTransactionModal .modal {
        max-width: 520px;
        border-radius: 14px;
        border: 1px solid #e2e8f0;
        box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.15);
    }

    #addTransactionModal .modal-header,
    #editTransactionModal .modal-header,
    #viewTransactionModal .modal-header {
        padding: 14px 20px;
        background: white;
    }

    #addTransactionModal .modal-body,
    #editTransactionModal .modal-body,
    #viewTransactionModal .modal-body {
        padding: 20px;
    }

    #addTransactionModal .modal-footer,
    #editTransactionModal .modal-footer,
    #viewTransactionModal .modal-footer {
        padding: 14px 20px;
        background: #f8fafc;
        border-radius: 0 0 14px 14px;
    }

    /* Mobile responsiveness */
    @media(max-width:640px) {
        .txn-stepper {
            padding: 10px 10px 6px;
        }

        .txn-step-connector {
            width: 16px;
        }

        .txn-step-label {
            font-size: 7px;
        }

        .txn-step-dot {
            width: 22px;
            height: 22px;
            font-size: 9px;
        }

        #addTransactionModal .modal-body,
        #editTransactionModal .modal-body,
        #viewTransactionModal .modal-body {
            padding: 14px;
        }

        #addTransactionModal .modal-header,
        #editTransactionModal .modal-header,
        #viewTransactionModal .modal-header,
        #addTransactionModal .modal-footer,
        #editTransactionModal .modal-footer,
        #viewTransactionModal .modal-footer {
            padding: 10px 14px;
        }
    }

    @media(prefers-reduced-motion:reduce) {

        .txn-enter,
        .txn-stagger>* {
            animation: none !important;
            opacity: 1 !important;
        }
    }
</style>

<div class="max-w-6xl mx-auto space-y-6 animate__animated animate__fadeIn">

    <!-- Page Header -->
    <div class="flex flex-col sm:flex-row sm:items-center justify-between gap-4">
        <div>
            <h2 class="text-2xl font-semibold text-slate-900 tracking-tight">Transactions</h2>
            <p class="text-sm text-slate-500 mt-1 font-light">View and manage all your income and expense transactions.
            </p>
        </div>
        <button class="btn btn-primary" onclick="openModal('addTransactionModal')">
            <iconify-icon icon="solar:add-circle-linear" width="16"></iconify-icon>
            Add Transaction
        </button>
    </div>

    <!-- Summary Cards -->
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
        <!-- Monthly Income -->
        <div class="card p-5 hover:border-emerald-200 transition-colors">
            <div class="flex justify-between items-start mb-4">
                <div class="text-slate-500 bg-slate-50 p-2 rounded-lg">
                    <iconify-icon icon="solar:wallet-linear" width="22" stroke-width="1.5"></iconify-icon>
                </div>
                <div
                    class="flex items-center gap-1 text-[10px] font-medium text-emerald-700 bg-emerald-50 px-2 py-1 rounded-full border border-emerald-100">
                    <iconify-icon icon="solar:trending-up-linear"></iconify-icon> 12%
                </div>
            </div>
            <div class="text-slate-500 text-xs font-medium mb-1 uppercase tracking-wide">Monthly Income</div>
            <div class="text-xl font-semibold text-slate-900 tracking-tight">$8,240.00</div>
        </div>

        <!-- Monthly Expenses -->
        <div class="card p-5 hover:border-amber-200 transition-colors">
            <div class="flex justify-between items-start mb-4">
                <div class="text-slate-500 bg-slate-50 p-2 rounded-lg">
                    <iconify-icon icon="solar:bag-3-linear" width="22" stroke-width="1.5"></iconify-icon>
                </div>
                <div
                    class="flex items-center gap-1 text-[10px] font-medium text-amber-700 bg-amber-50 px-2 py-1 rounded-full border border-amber-100">
                    <iconify-icon icon="solar:trending-up-linear"></iconify-icon> 5.4%
                </div>
            </div>
            <div class="text-slate-500 text-xs font-medium mb-1 uppercase tracking-wide">Monthly Expenses</div>
            <div class="text-xl font-semibold text-slate-900 tracking-tight">$3,405.50</div>
        </div>

        <!-- Net Balance -->
        <div class="card p-5 hover:border-slate-300 transition-colors">
            <div class="flex justify-between items-start mb-4">
                <div class="text-slate-500 bg-slate-50 p-2 rounded-lg">
                    <iconify-icon icon="solar:scale-linear" width="22" stroke-width="1.5"></iconify-icon>
                </div>
            </div>
            <div class="text-slate-500 text-xs font-medium mb-1 uppercase tracking-wide">Net Balance</div>
            <div class="text-xl font-semibold text-slate-900 tracking-tight">$4,834.50</div>
        </div>

        <!-- Savings Rate -->
        <div class="card p-5 hover:border-blue-200 transition-colors">
            <div class="flex justify-between items-start mb-4">
                <div class="text-slate-500 bg-slate-50 p-2 rounded-lg">
                    <iconify-icon icon="solar:pig-money-linear" width="22" stroke-width="1.5"></iconify-icon>
                </div>
                <div
                    class="flex items-center gap-1 text-[10px] font-medium text-slate-500 bg-slate-100 px-2 py-1 rounded-full border border-slate-200">
                    Target: 50%
                </div>
            </div>
            <div class="text-slate-500 text-xs font-medium mb-1 uppercase tracking-wide flex items-center gap-1">
                Savings Rate
                <iconify-icon icon="solar:info-circle-linear" class="text-slate-400 cursor-help"
                    title="Percentage of income saved"></iconify-icon>
            </div>
            <div class="text-xl font-semibold text-slate-900 tracking-tight">58.6%</div>
        </div>
    </div>

    <!-- Charts Section -->
    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
        <!-- Income vs Expenses Chart -->
        <div class="lg:col-span-2 bg-white rounded-xl border border-slate-200/60 shadow-sm p-6">
            <div class="flex items-center justify-between mb-8">
                <div>
                    <h3 class="text-sm font-semibold text-slate-900">Income vs Expenses</h3>
                    <p class="text-xs text-slate-500 mt-1 font-light">6-month comparison.</p>
                </div>
                <div class="flex gap-3">
                    <div class="flex items-center gap-1.5">
                        <div class="w-2 h-2 rounded-full bg-slate-300"></div><span
                            class="text-[10px] font-medium text-slate-500">Income</span>
                    </div>
                    <div class="flex items-center gap-1.5">
                        <div class="w-2 h-2 rounded-full bg-emerald-500"></div><span
                            class="text-[10px] font-medium text-slate-500">Expense</span>
                    </div>
                </div>
            </div>

            <!-- CSS Bar Chart Visualization -->
            <div class="h-60 flex items-end justify-between gap-2 sm:gap-6 px-2 border-b border-slate-50 relative">
                <div class="absolute inset-0 flex flex-col justify-between pointer-events-none">
                    <div class="w-full h-px bg-slate-100/50"></div>
                    <div class="w-full h-px bg-slate-100/50"></div>
                    <div class="w-full h-px bg-slate-100/50"></div>
                    <div class="w-full h-px bg-slate-100/50"></div>
                    <div class="w-full h-px bg-slate-100/50"></div>
                </div>
                <!-- Data Bars -->
                <div class="flex gap-1 h-full items-end flex-1 justify-center z-10 group cursor-pointer">
                    <div class="w-3 sm:w-5 bg-slate-300 rounded-t-[2px] h-[45%]"></div>
                    <div class="w-3 sm:w-5 bg-emerald-500 rounded-t-[2px] h-[35%]"></div>
                </div>
                <div class="flex gap-1 h-full items-end flex-1 justify-center z-10 group cursor-pointer">
                    <div class="w-3 sm:w-5 bg-slate-300 rounded-t-[2px] h-[55%]"></div>
                    <div class="w-3 sm:w-5 bg-emerald-500 rounded-t-[2px] h-[40%]"></div>
                </div>
                <div class="flex gap-1 h-full items-end flex-1 justify-center z-10 group cursor-pointer">
                    <div class="w-3 sm:w-5 bg-slate-300 rounded-t-[2px] h-[48%]"></div>
                    <div class="w-3 sm:w-5 bg-emerald-500 rounded-t-[2px] h-[42%]"></div>
                </div>
                <div class="flex gap-1 h-full items-end flex-1 justify-center z-10 group cursor-pointer">
                    <div class="w-3 sm:w-5 bg-slate-300 rounded-t-[2px] h-[65%]"></div>
                    <div class="w-3 sm:w-5 bg-emerald-500 rounded-t-[2px] h-[45%]"></div>
                </div>
                <div class="flex gap-1 h-full items-end flex-1 justify-center z-10 group cursor-pointer">
                    <div class="w-3 sm:w-5 bg-slate-300 rounded-t-[2px] h-[72%]"></div>
                    <div class="w-3 sm:w-5 bg-emerald-500 rounded-t-[2px] h-[38%]"></div>
                </div>
                <div class="flex gap-1 h-full items-end flex-1 justify-center z-10 group cursor-pointer">
                    <div class="w-3 sm:w-5 bg-slate-300 rounded-t-[2px] h-[82%]"></div>
                    <div class="w-3 sm:w-5 bg-emerald-500 rounded-t-[2px] h-[34%]"></div>
                </div>
            </div>
            <div class="flex justify-between mt-4 text-[10px] font-medium text-slate-400 px-4 uppercase tracking-wider">
                <span>May</span><span>Jun</span><span>Jul</span><span>Aug</span><span>Sep</span><span
                    class="text-slate-600">Oct</span>
            </div>
        </div>

        <!-- Expense Categories -->
        <div class="bg-white rounded-xl border border-slate-200/60 shadow-sm p-6 flex flex-col">
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-sm font-semibold text-slate-900">Categories</h3>
                <button class="text-slate-400 hover:text-slate-600"><iconify-icon
                        icon="solar:menu-dots-bold"></iconify-icon></button>
            </div>

            <div class="flex items-center gap-6 mb-6">
                <!-- Donut Chart -->
                <div class="w-32 h-32 mx-auto rounded-full flex-shrink-0 relative"
                    style="background: conic-gradient(#10b981 0% 35%, #f59e0b 35% 65%, #64748b 65% 85%, #cbd5e1 85% 100%);">
                    <div
                        class="absolute inset-0 m-auto w-20 h-20 bg-white rounded-full flex flex-col items-center justify-center shadow-sm">
                        <span class="text-xs text-slate-400 font-medium">Total</span>
                        <span class="text-sm font-bold text-slate-900">$3.4k</span>
                    </div>
                </div>
            </div>

            <div class="space-y-3 flex-1">
                <div class="flex items-center justify-between text-xs">
                    <div class="flex items-center gap-2">
                        <div class="w-2 h-2 rounded-full bg-emerald-500"></div><span class="text-slate-600">Food</span>
                    </div>
                    <span class="font-medium text-slate-900">$1,191</span>
                </div>
                <div class="flex items-center justify-between text-xs">
                    <div class="flex items-center gap-2">
                        <div class="w-2 h-2 rounded-full bg-amber-500"></div><span class="text-slate-600">Housing</span>
                    </div>
                    <span class="font-medium text-slate-900">$1,021</span>
                </div>
                <div class="flex items-center justify-between text-xs">
                    <div class="flex items-center gap-2">
                        <div class="w-2 h-2 rounded-full bg-slate-500"></div><span
                            class="text-slate-600">Transport</span>
                    </div>
                    <span class="font-medium text-slate-900">$681</span>
                </div>
                <div class="flex items-center justify-between text-xs">
                    <div class="flex items-center gap-2">
                        <div class="w-2 h-2 rounded-full bg-slate-300"></div><span class="text-slate-600">Other</span>
                    </div>
                    <span class="font-medium text-slate-900">$511</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Filters -->
    <div class="bg-white rounded-xl border border-slate-200/60 shadow-sm p-4">
        <div class="flex flex-col xl:flex-row items-center gap-3">
            <div class="flex items-center gap-2 text-xs text-slate-500 w-full xl:w-auto">
                <iconify-icon icon="solar:filter-linear" width="16"></iconify-icon>
                <span class="font-medium">Filters</span>
            </div>
            <div class="hidden xl:block h-4 w-px bg-slate-200"></div>

            <div class="relative w-full xl:w-64">
                <iconify-icon icon="solar:magnifer-linear"
                    class="absolute left-3 top-1/2 -translate-y-1/2 text-slate-400" width="14"></iconify-icon>
                <input type="text" placeholder="Search transactions..." class="form-input py-1.5 pl-9 text-xs w-full">
            </div>

            <div class="grid grid-cols-2 md:grid-cols-4 xl:flex items-center gap-2 w-full xl:w-auto">
                <select class="form-input form-select py-1.5 px-3 text-xs w-full">
                    <option>October</option>
                    <option>September</option>
                    <option>August</option>
                </select>
                <select class="form-input form-select py-1.5 px-3 text-xs w-full">
                    <option>2023</option>
                    <option>2022</option>
                </select>
                <select class="form-input form-select py-1.5 px-3 text-xs w-full">
                    <option>All Types</option>
                    <option>Income</option>
                    <option>Expense</option>
                </select>
                <select class="form-input form-select py-1.5 px-3 text-xs w-full">
                    <option>All Accounts</option>
                    <option>Chase Sapphire</option>
                    <option>Checking</option>
                </select>
            </div>

            <div class="grid grid-cols-2 md:grid-cols-2 xl:flex items-center gap-2 w-full xl:w-auto">
                <select class="form-input form-select py-1.5 px-3 text-xs w-full">
                    <option>All Categories</option>
                    <option>Groceries</option>
                    <option>Transport</option>
                </select>
                <select class="form-input form-select py-1.5 px-3 text-xs w-full">
                    <option>All Goals</option>
                    <option>Emergency Fund</option>
                    <option>New Car</option>
                </select>
            </div>

            <div class="flex-1"></div>
            <div class="flex items-center gap-2 w-full xl:w-auto">
                <button class="btn btn-secondary text-xs w-full xl:w-auto justify-center" title="Reset Filters">
                    <iconify-icon icon="solar:restart-linear" width="14"></iconify-icon>
                </button>
                <button class="btn btn-secondary text-xs w-full xl:w-auto justify-center">
                    <iconify-icon icon="solar:export-linear" width="14"></iconify-icon>
                    Export
                </button>
            </div>
        </div>
    </div>

    <!-- Goal Filter Banner (Hidden by default) -->
    <div class="bg-emerald-50 border border-emerald-100 rounded-lg p-3 flex items-center justify-between hidden">
        <div class="flex items-center gap-3">
            <div class="w-8 h-8 rounded-full bg-emerald-100 text-emerald-600 flex items-center justify-center">
                <iconify-icon icon="solar:target-bold" width="16"></iconify-icon>
            </div>
            <div>
                <div class="text-xs font-semibold text-slate-900">Filtered by Goal: Emergency Fund</div>
                <div class="text-[10px] text-slate-500">Showing transactions related to this goal.</div>
            </div>
        </div>
        <button class="text-slate-400 hover:text-slate-600">
            <iconify-icon icon="solar:close-circle-linear" width="18"></iconify-icon>
        </button>
    </div>

    <!-- Transactions Table -->
    <div class="bg-white rounded-xl border border-slate-200/60 shadow-sm overflow-hidden">
        <!-- Desktop Table View -->
        <div class="overflow-x-auto hidden md:block">
            <table class="w-full text-left border-collapse">
                <thead>
                    <tr
                        class="bg-slate-50/50 border-b border-slate-200 text-[10px] text-slate-500 uppercase tracking-widest font-semibold">
                        <th class="px-6 py-3 cursor-pointer hover:text-slate-700 transition-colors">
                            <div class="flex items-center gap-1">
                                Date <iconify-icon icon="solar:sort-vertical-linear" width="12"></iconify-icon>
                            </div>
                        </th>
                        <th class="px-6 py-3">Description</th>
                        <th class="px-6 py-3 cursor-pointer hover:text-slate-700 transition-colors">
                            <div class="flex items-center gap-1">
                                Category <iconify-icon icon="solar:sort-vertical-linear" width="12"></iconify-icon>
                            </div>
                        </th>
                        <th class="px-6 py-3">Account</th>
                        <th class="px-6 py-3 text-right cursor-pointer hover:text-slate-700 transition-colors">
                            <div class="flex items-center gap-1 justify-end">
                                Amount <iconify-icon icon="solar:sort-vertical-linear" width="12"></iconify-icon>
                            </div>
                        </th>
                        <th class="px-6 py-3 text-center">Actions</th>
                    </tr>
                </thead>
                <tbody class="text-xs text-slate-600 divide-y divide-slate-50">
                    <tr class="group hover:bg-slate-50/80 transition-colors">
                        <td class="px-6 py-4 text-slate-400">Oct 24, 2:30 PM</td>
                        <td class="px-6 py-4 font-medium text-slate-900">Whole Foods Market</td>
                        <td class="px-6 py-4"><span class="badge badge-success">Groceries</span></td>
                        <td class="px-6 py-4 text-slate-500">Chase •••• 4242</td>
                        <td class="px-6 py-4 text-right font-medium text-slate-900">-$86.42</td>
                        <td class="px-6 py-4">
                            <div
                                class="flex items-center justify-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity">
                                <button class="action-btn" title="View Details"
                                    onclick="openModal('viewTransactionModal')"><iconify-icon icon="solar:eye-linear"
                                        width="16"></iconify-icon></button>
                                <button class="action-btn edit" title="Edit"
                                    onclick="openModal('editTransactionModal')"><iconify-icon icon="solar:pen-linear"
                                        width="16"></iconify-icon></button>
                                <button class="action-btn delete" title="Delete"
                                    onclick="openModal('deleteTransactionModal')"><iconify-icon
                                        icon="solar:trash-bin-trash-linear" width="16"></iconify-icon></button>
                            </div>
                        </td>
                    </tr>
                    <tr class="group hover:bg-slate-50/80 transition-colors">
                        <td class="px-6 py-4 text-slate-400">Oct 24, 9:00 AM</td>
                        <td class="px-6 py-4 font-medium text-slate-900">Tech Corp Salary</td>
                        <td class="px-6 py-4"><span class="badge badge-info">Income</span></td>
                        <td class="px-6 py-4 text-slate-500">Checking •••• 8890</td>
                        <td class="px-6 py-4 text-right font-medium text-emerald-600">+$2,450.00</td>
                        <td class="px-6 py-4">
                            <div
                                class="flex items-center justify-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity">
                                <button class="action-btn" title="View Details"
                                    onclick="openModal('viewTransactionModal')"><iconify-icon icon="solar:eye-linear"
                                        width="16"></iconify-icon></button>
                                <button class="action-btn edit" title="Edit"
                                    onclick="openModal('editTransactionModal')"><iconify-icon icon="solar:pen-linear"
                                        width="16"></iconify-icon></button>
                                <button class="action-btn delete" title="Delete"
                                    onclick="openModal('deleteTransactionModal')"><iconify-icon
                                        icon="solar:trash-bin-trash-linear" width="16"></iconify-icon></button>
                            </div>
                        </td>
                    </tr>
                    <tr class="group hover:bg-slate-50/80 transition-colors">
                        <td class="px-6 py-4 text-slate-400">Oct 23, 7:15 PM</td>
                        <td class="px-6 py-4 font-medium text-slate-900">Uber Trip</td>
                        <td class="px-6 py-4"><span class="badge badge-neutral">Transport</span></td>
                        <td class="px-6 py-4 text-slate-500">Chase •••• 4242</td>
                        <td class="px-6 py-4 text-right font-medium text-slate-900">-$14.50</td>
                        <td class="px-6 py-4">
                            <div
                                class="flex items-center justify-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity">
                                <button class="action-btn" title="View Details"
                                    onclick="openModal('viewTransactionModal')"><iconify-icon icon="solar:eye-linear"
                                        width="16"></iconify-icon></button>
                                <button class="action-btn edit" title="Edit"
                                    onclick="openModal('editTransactionModal')"><iconify-icon icon="solar:pen-linear"
                                        width="16"></iconify-icon></button>
                                <button class="action-btn delete" title="Delete"
                                    onclick="openModal('deleteTransactionModal')"><iconify-icon
                                        icon="solar:trash-bin-trash-linear" width="16"></iconify-icon></button>
                            </div>
                        </td>
                    </tr>
                    <tr class="group hover:bg-slate-50/80 transition-colors">
                        <td class="px-6 py-4 text-slate-400">Oct 22, 6:30 PM</td>
                        <td class="px-6 py-4 font-medium text-slate-900">Netflix Subscription</td>
                        <td class="px-6 py-4"><span class="badge badge-warning">Entertainment</span></td>
                        <td class="px-6 py-4 text-slate-500">Chase •••• 4242</td>
                        <td class="px-6 py-4 text-right font-medium text-slate-900">-$15.99</td>
                        <td class="px-6 py-4">
                            <div
                                class="flex items-center justify-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity">
                                <button class="action-btn" title="View Details"
                                    onclick="openModal('viewTransactionModal')"><iconify-icon icon="solar:eye-linear"
                                        width="16"></iconify-icon></button>
                                <button class="action-btn edit" title="Edit"
                                    onclick="openModal('editTransactionModal')"><iconify-icon icon="solar:pen-linear"
                                        width="16"></iconify-icon></button>
                                <button class="action-btn delete" title="Delete"
                                    onclick="openModal('deleteTransactionModal')"><iconify-icon
                                        icon="solar:trash-bin-trash-linear" width="16"></iconify-icon></button>
                            </div>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- Mobile Card View -->
        <div class="md:hidden divide-y divide-slate-100">
            <!-- Transaction Card 1 -->
            <div class="p-4 hover:bg-slate-50 transition-colors cursor-pointer"
                onclick="openModal('viewTransactionModal')">
                <div class="flex items-start justify-between mb-3">
                    <div class="flex-1">
                        <div class="text-sm font-semibold text-slate-900 mb-1">Whole Foods Market</div>
                        <div class="text-xs text-slate-500">Oct 24, 2:30 PM</div>
                    </div>
                    <div class="text-right">
                        <div class="text-sm font-bold text-slate-900">-$86.42</div>
                    </div>
                </div>
                <div class="flex items-center justify-between">
                    <div class="flex items-center gap-2">
                        <span class="badge badge-success text-[10px]">Groceries</span>
                        <span class="text-xs text-slate-400">Chase •••• 4242</span>
                    </div>
                    <div class="flex items-center gap-1">
                        <button class="action-btn" title="Edit"
                            onclick="event.stopPropagation(); openModal('editTransactionModal')"><iconify-icon
                                icon="solar:pen-linear" width="14"></iconify-icon></button>
                        <button class="action-btn delete" title="Delete"
                            onclick="event.stopPropagation(); openModal('deleteTransactionModal')"><iconify-icon
                                icon="solar:trash-bin-trash-linear" width="14"></iconify-icon></button>
                    </div>
                </div>
            </div>

            <!-- Transaction Card 2 -->
            <div class="p-4 hover:bg-slate-50 transition-colors cursor-pointer"
                onclick="openModal('viewTransactionModal')">
                <div class="flex items-start justify-between mb-3">
                    <div class="flex-1">
                        <div class="text-sm font-semibold text-slate-900 mb-1">Tech Corp Salary</div>
                        <div class="text-xs text-slate-500">Oct 24, 9:00 AM</div>
                    </div>
                    <div class="text-right">
                        <div class="text-sm font-bold text-emerald-600">+$2,450.00</div>
                    </div>
                </div>
                <div class="flex items-center justify-between">
                    <div class="flex items-center gap-2">
                        <span class="badge badge-info text-[10px]">Income</span>
                        <span class="text-xs text-slate-400">Checking •••• 8890</span>
                    </div>
                    <div class="flex items-center gap-1">
                        <button class="action-btn" title="Edit"
                            onclick="event.stopPropagation(); openModal('editTransactionModal')"><iconify-icon
                                icon="solar:pen-linear" width="14"></iconify-icon></button>
                        <button class="action-btn delete" title="Delete"
                            onclick="event.stopPropagation(); openModal('deleteTransactionModal')"><iconify-icon
                                icon="solar:trash-bin-trash-linear" width="14"></iconify-icon></button>
                    </div>
                </div>
            </div>

            <!-- Transaction Card 3 -->
            <div class="p-4 hover:bg-slate-50 transition-colors cursor-pointer"
                onclick="openModal('viewTransactionModal')">
                <div class="flex items-start justify-between mb-3">
                    <div class="flex-1">
                        <div class="text-sm font-semibold text-slate-900 mb-1">Uber Trip</div>
                        <div class="text-xs text-slate-500">Oct 23, 7:15 PM</div>
                    </div>
                    <div class="text-right">
                        <div class="text-sm font-bold text-slate-900">-$14.50</div>
                    </div>
                </div>
                <div class="flex items-center justify-between">
                    <div class="flex items-center gap-2">
                        <span class="badge badge-neutral text-[10px]">Transport</span>
                        <span class="text-xs text-slate-400">Chase •••• 4242</span>
                    </div>
                    <div class="flex items-center gap-1">
                        <button class="action-btn" title="Edit"
                            onclick="event.stopPropagation(); openModal('editTransactionModal')"><iconify-icon
                                icon="solar:pen-linear" width="14"></iconify-icon></button>
                        <button class="action-btn delete" title="Delete"
                            onclick="event.stopPropagation(); openModal('deleteTransactionModal')"><iconify-icon
                                icon="solar:trash-bin-trash-linear" width="14"></iconify-icon></button>
                    </div>
                </div>
            </div>

            <!-- Transaction Card 4 -->
            <div class="p-4 hover:bg-slate-50 transition-colors cursor-pointer"
                onclick="openModal('viewTransactionModal')">
                <div class="flex items-start justify-between mb-3">
                    <div class="flex-1">
                        <div class="text-sm font-semibold text-slate-900 mb-1">Netflix Subscription</div>
                        <div class="text-xs text-slate-500">Oct 22, 6:30 PM</div>
                    </div>
                    <div class="text-right">
                        <div class="text-sm font-bold text-slate-900">-$15.99</div>
                    </div>
                </div>
                <div class="flex items-center justify-between">
                    <div class="flex items-center gap-2">
                        <span class="badge badge-warning text-[10px]">Entertainment</span>
                        <span class="text-xs text-slate-400">Chase •••• 4242</span>
                    </div>
                    <div class="flex items-center gap-1">
                        <button class="action-btn" title="Edit"
                            onclick="event.stopPropagation(); openModal('editTransactionModal')"><iconify-icon
                                icon="solar:pen-linear" width="14"></iconify-icon></button>
                        <button class="action-btn delete" title="Delete"
                            onclick="event.stopPropagation(); openModal('deleteTransactionModal')"><iconify-icon
                                icon="solar:trash-bin-trash-linear" width="14"></iconify-icon></button>
                    </div>
                </div>
            </div>
        </div>
        <div class="flex items-center justify-between px-4 py-3 border-t border-slate-100/80 mt-1">
            <div class="text-[11px] text-slate-400 font-light">
                Showing <span class="text-slate-600 font-medium">1-10</span> of <span
                    class="text-slate-600 font-medium">128</span>
            </div>
            <div class="flex items-center gap-0.5">
                <button
                    class="p-1.5 rounded-md text-slate-300 hover:text-slate-600 hover:bg-slate-50 disabled:opacity-20 transition-all"
                    disabled>
                    <iconify-icon icon="solar:alt-arrow-left-linear" width="14"></iconify-icon>
                </button>
                <button
                    class="w-7 h-7 rounded-md bg-emerald-50/60 text-emerald-600 text-[11px] font-bold flex items-center justify-center">1</button>
                <button
                    class="w-7 h-7 rounded-md text-slate-400 hover:text-slate-600 hover:bg-slate-50 text-[11px] font-medium transition-all">2</button>
                <button
                    class="w-7 h-7 rounded-md text-slate-400 hover:text-slate-600 hover:bg-slate-50 text-[11px] font-medium transition-all">3</button>
                <span class="px-1 text-slate-200 text-[10px]">...</span>
                <button
                    class="w-7 h-7 rounded-md text-slate-400 hover:text-slate-600 hover:bg-slate-50 text-[11px] font-medium transition-all">12</button>
                <button class="p-1.5 rounded-md text-slate-400 hover:text-slate-600 hover:bg-slate-50 transition-all">
                    <iconify-icon icon="solar:alt-arrow-right-linear" width="14"></iconify-icon>
                </button>
            </div>
        </div>
    </div>
    <!-- Mobile FAB -->
    <button
        class="md:hidden fixed bottom-6 right-6 w-12 h-12 bg-emerald-600 text-white rounded-full shadow-lg flex items-center justify-center hover:bg-emerald-700 transition-colors z-50"
        onclick="openModal('addTransactionModal')">
        <iconify-icon icon="solar:add-circle-bold" width="24"></iconify-icon>
    </button>
</div>

<!-- Add Transaction Modal -->
<div id="addTransactionModal" class="modal-overlay" role="dialog" aria-modal="true" aria-labelledby="addTxnHeaderTitle">
    <div class="modal w-full mx-4 flex flex-col max-h-[90vh]">
        <!-- Header -->
        <div class="modal-header flex items-center justify-between border-b border-slate-100">
            <h3 class="text-xs font-bold text-slate-900 flex items-center gap-2 uppercase tracking-wider">
                <span id="addTxnHeaderTitle">Add Transaction</span>
            </h3>
            <div class="flex items-center gap-3">
                <span id="addTxnStepText" class="text-[10px] text-slate-400 font-medium tracking-wide">Step 1 of
                    3</span>
                <button
                    class="w-7 h-7 rounded-lg flex items-center justify-center text-slate-300 hover:text-slate-600 hover:bg-slate-50 transition-all"
                    onclick="closeModal('addTransactionModal')" aria-label="Close">
                    <iconify-icon icon="solar:close-circle-linear" width="18"></iconify-icon>
                </button>
            </div>
        </div>

        <!-- Step Stepper -->
        <div class="txn-stepper" aria-label="Transaction setup progress">
            <div class="txn-step-wrap">
                <div class="txn-step-dot active" data-step="1" aria-current="step">1</div><span
                    class="txn-step-label active">Type</span>
            </div>
            <div class="txn-step-connector" data-connector="1"></div>
            <div class="txn-step-wrap">
                <div class="txn-step-dot" data-step="2">2</div><span class="txn-step-label">Details</span>
            </div>
            <div class="txn-step-connector" data-connector="2"></div>
            <div class="txn-step-wrap">
                <div class="txn-step-dot" data-step="3">3</div><span class="txn-step-label">Review</span>
            </div>
        </div>

        <!-- Main Body -->
        <div class="modal-body overflow-y-auto flex-1">

            <!-- STEP 1: Transaction Type -->
            <div id="addTxnStep1" class="setup-step txn-enter">
                <div class="mb-5">
                    <h2 class="text-[17px] font-bold text-slate-900 mb-1">Transaction Type</h2>
                    <p class="text-[11px] text-slate-500">Select the type of transaction you want to record.</p>
                </div>
                <div class="grid grid-cols-1 gap-3 txn-stagger">
                    <div onclick="selectTxnType('expense')" id="txnTypeExpense" class="txn-card" role="button"
                        tabindex="0" onkeydown="if(event.key==='Enter')selectTxnType('expense')">
                        <div class="flex items-start gap-4">
                            <div class="txn-icon"><iconify-icon icon="solar:minus-circle-linear"
                                    width="18"></iconify-icon></div>
                            <div class="flex-1 min-w-0">
                                <h3 class="text-[13px] font-bold text-slate-900 mb-0.5">Expense</h3>
                                <p class="text-[11px] text-slate-500 leading-relaxed">Money spent on goods, services, or
                                    bills.</p>
                            </div>
                            <div class="txn-check"><iconify-icon icon="solar:check-read-linear"
                                    width="10"></iconify-icon></div>
                        </div>
                    </div>
                    <div onclick="selectTxnType('income')" id="txnTypeIncome" class="txn-card" role="button"
                        tabindex="0" onkeydown="if(event.key==='Enter')selectTxnType('income')">
                        <div class="flex items-start gap-4">
                            <div class="txn-icon"><iconify-icon icon="solar:add-circle-linear"
                                    width="18"></iconify-icon></div>
                            <div class="flex-1 min-w-0">
                                <h3 class="text-[13px] font-bold text-slate-900 mb-0.5">Income</h3>
                                <p class="text-[11px] text-slate-500 leading-relaxed">Money received from salary,
                                    investments, or other sources.</p>
                            </div>
                            <div class="txn-check"><iconify-icon icon="solar:check-read-linear"
                                    width="10"></iconify-icon></div>
                        </div>
                    </div>
                    <div onclick="selectTxnType('contribution')" id="txnTypeContribution" class="txn-card" role="button"
                        tabindex="0" onkeydown="if(event.key==='Enter')selectTxnType('contribution')">
                        <div class="flex items-start gap-4">
                            <div class="txn-icon"><iconify-icon icon="solar:flag-linear" width="18"></iconify-icon>
                            </div>
                            <div class="flex-1 min-w-0">
                                <h3 class="text-[13px] font-bold text-slate-900 mb-0.5">Contribution</h3>
                                <p class="text-[11px] text-slate-500 leading-relaxed">Money allocated to savings goals
                                    or investments.</p>
                            </div>
                            <div class="txn-check"><iconify-icon icon="solar:check-read-linear"
                                    width="10"></iconify-icon></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- STEP 2: Transaction Details -->
            <div id="addTxnStep2" class="setup-step hidden">
                <div class="mb-5">
                    <h2 class="text-[17px] font-bold text-slate-900 mb-1 flex items-center gap-2.5">
                        <div class="txn-icon" style="width:30px;height:30px;border-radius:8px;"><iconify-icon
                                icon="solar:pen-new-square-linear" width="14"></iconify-icon></div>
                        Transaction Details
                    </h2>
                </div>
                <div class="space-y-5 txn-stagger">
                    <div>
                        <label class="txn-label" for="txnAmount">Amount <span class="text-slate-400">*</span></label>
                        <div class="relative">
                            <span
                                class="absolute left-3.5 top-1/2 -translate-y-1/2 text-slate-400 font-semibold text-xs">$</span>
                            <input type="number" id="txnAmount" step="0.01" class="txn-input pl-7" placeholder="0.00"
                                required>
                        </div>
                    </div>
                    <div>
                        <label class="txn-label" for="txnDate">Date <span class="text-slate-400">*</span></label>
                        <input type="date" id="txnDate" class="txn-input" required>
                    </div>
                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label class="txn-label" for="txnCategory">Category</label>
                            <select id="txnCategory" class="txn-input">
                                <option value="">Select category...</option>
                                <option value="groceries">Groceries</option>
                                <option value="transport">Transport</option>
                                <option value="entertainment">Entertainment</option>
                                <option value="utilities">Utilities</option>
                                <option value="salary">Salary</option>
                                <option value="other">Other</option>
                            </select>
                        </div>
                        <div>
                            <label class="txn-label" for="tnxBudget">Budget</label>
                            <select id="tnxBudget" class="txn-input">
                                <option value="">No budget</option>
                                <option value="monthly">Monthly Budget</option>
                                <option value="holiday">Holiday Trip</option>
                            </select>
                        </div>
                    </div>
                    <div>
                        <label class="txn-label" for="txnGoal">Goal Contribution</label>
                        <div class="relative">
                            <iconify-icon icon="solar:target-linear"
                                class="absolute left-3.5 top-1/2 -translate-y-1/2 text-slate-400"
                                width="14"></iconify-icon>
                            <select id="txnGoal" class="txn-input pl-9">
                                <option value="">No Goal</option>
                                <option value="emergency">Emergency Fund (50%)</option>
                                <option value="car">New Car (20%)</option>
                            </select>
                        </div>
                    </div>
                    <div>
                        <label class="txn-label" for="txnAccount">Account <span class="text-slate-400">*</span></label>
                        <select id="txnAccount" class="txn-input" required>
                            <option value="">Select account...</option>
                            <option value="chase">Chase Sapphire</option>
                            <option value="checking">Checking</option>
                            <option value="savings">Savings</option>
                        </select>
                    </div>
                    <div>
                        <label class="txn-label" for="txnDescription">Description <span
                                class="text-slate-400 font-normal lowercase"
                                style="letter-spacing:0">(optional)</span></label>
                        <textarea id="txnDescription" rows="2" class="txn-input resize-none"
                            placeholder="What was this transaction for?"></textarea>
                    </div>
                </div>
            </div>

            <!-- STEP 3: Review -->
            <div id="addTxnStep3" class="setup-step hidden">
                <div class="mb-5">
                    <h2 class="text-[17px] font-bold text-slate-900 mb-1 flex items-center gap-2.5">
                        <div class="txn-icon" style="width:30px;height:30px;border-radius:8px;"><iconify-icon
                                icon="solar:clipboard-check-linear" width="14"></iconify-icon></div>
                        Review & Confirm
                    </h2>
                </div>
                <div class="space-y-4 txn-stagger">
                    <div class="txn-amount-display">
                        <div class="text-xs text-slate-500 uppercase tracking-wide mb-1">Transaction Amount</div>
                        <div id="reviewAmount" class="txn-amount-value">$0.00</div>
                        <div id="reviewType"
                            class="text-xs font-semibold px-2 py-1 rounded bg-slate-100 text-slate-500 uppercase tracking-wider inline-block mt-2">
                            Expense</div>
                    </div>
                    <div class="txn-review">
                        <div class="txn-review-body">
                            <div class="txn-review-row">
                                <span
                                    class="text-[10px] uppercase tracking-widest text-slate-400 font-semibold">Date</span>
                                <span id="reviewDate" class="text-[13px] font-semibold text-slate-700">-</span>
                            </div>
                            <div class="txn-review-row">
                                <span
                                    class="text-[10px] uppercase tracking-widest text-slate-400 font-semibold">Category</span>
                                <span id="reviewCategory" class="text-[13px] font-semibold text-slate-700">-</span>
                            </div>
                            <div class="txn-review-row">
                                <span
                                    class="text-[10px] uppercase tracking-widest text-slate-400 font-semibold">Account</span>
                                <span id="reviewAccount" class="text-[13px] font-semibold text-slate-700">-</span>
                            </div>
                            <div class="txn-review-row">
                                <span
                                    class="text-[10px] uppercase tracking-widest text-slate-400 font-semibold">Goal</span>
                                <span id="reviewGoal" class="text-[13px] font-semibold text-slate-700">-</span>
                            </div>
                            <div class="txn-review-row">
                                <span
                                    class="text-[10px] uppercase tracking-widest text-slate-400 font-semibold">Description</span>
                                <span id="reviewDescription"
                                    class="text-[11px] text-slate-500 italic max-w-[180px] text-right">No description
                                    provided.</span>
                            </div>
                        </div>
                    </div>
                    <div class="txn-notice warn">
                        <iconify-icon icon="solar:danger-triangle-linear" width="16"
                            class="flex-shrink-0 mt-px"></iconify-icon>
                        <div>
                            <h4 class="font-bold text-[10px] uppercase tracking-widest mb-0.5">Action is final</h4>
                            <p class="text-[11px] leading-relaxed" style="opacity:0.85">Your transaction will be created
                                immediately. Please ensure all details are correct.</p>
                        </div>
                    </div>
                </div>
            </div>

        </div>

        <!-- Footer -->
        <div class="modal-footer flex justify-between border-t border-slate-100">
            <button id="addTxnBtnBack" onclick="addTxnPreviousStep()" class="btn btn-secondary hidden">
                <iconify-icon icon="solar:arrow-left-linear" class="mr-1"></iconify-icon> Back
            </button>
            <div class="flex-1"></div>
            <button id="addTxnBtnNext" onclick="addTxnNextStep()" class="btn btn-primary" disabled
                style="background:#10b981; box-shadow:none;">
                Continue <iconify-icon icon="solar:arrow-right-linear" class="ml-1"></iconify-icon>
            </button>
        </div>
    </div>
</div>

<!-- View Details Modal -->
<div id="viewTransactionModal" class="modal-overlay" role="dialog" aria-modal="true"
    aria-labelledby="viewTxnHeaderTitle">
    <div class="modal w-full mx-4 flex flex-col max-h-[90vh]">
        <!-- Header -->
        <div class="modal-header flex items-center justify-between border-b border-slate-100">
            <h3 class="text-xs font-bold text-slate-900 flex items-center gap-2 uppercase tracking-wider">
                <span id="viewTxnHeaderTitle">Transaction Details</span>
            </h3>
            <div class="flex items-center gap-3">
                <span id="viewTxnStepText" class="text-[10px] text-slate-400 font-medium tracking-wide">Step 1 of
                    2</span>
                <button
                    class="w-7 h-7 rounded-lg flex items-center justify-center text-slate-300 hover:text-slate-600 hover:bg-slate-50 transition-all"
                    onclick="closeModal('viewTransactionModal')" aria-label="Close">
                    <iconify-icon icon="solar:close-circle-linear" width="18"></iconify-icon>
                </button>
            </div>
        </div>

        <!-- Step Stepper -->
        <div class="txn-stepper" aria-label="Transaction view progress">
            <div class="txn-step-wrap">
                <div class="txn-step-dot active" data-step="1" aria-current="step">1</div><span
                    class="txn-step-label active">Overview</span>
            </div>
            <div class="txn-step-connector" data-connector="1"></div>
            <div class="txn-step-wrap">
                <div class="txn-step-dot" data-step="2">2</div><span class="txn-step-label">Analysis</span>
            </div>
        </div>

        <!-- Main Body -->
        <div class="modal-body overflow-y-auto flex-1">

            <!-- STEP 1: Transaction Overview -->
            <div id="viewTxnStep1" class="setup-step txn-enter">
                <div class="space-y-6 txn-stagger">
                    <!-- Amount Display -->
                    <div class="txn-amount-display">
                        <div class="text-xs text-slate-500 uppercase tracking-wide mb-1">Transaction Amount</div>
                        <div class="txn-amount-value expense">-$86.42</div>
                        <div
                            class="text-xs font-semibold px-2 py-1 rounded bg-slate-100 text-slate-500 uppercase tracking-wider inline-block mt-2">
                            Expense</div>
                    </div>

                    <!-- Transaction Details -->
                    <div class="txn-review">
                        <div class="txn-review-body">
                            <div class="txn-review-row">
                                <span class="text-[10px] uppercase tracking-widest text-slate-400 font-semibold">Date &
                                    Time</span>
                                <span class="text-[13px] font-semibold text-slate-700">Oct 24, 2023, 2:30 PM</span>
                            </div>
                            <div class="txn-review-row">
                                <span
                                    class="text-[10px] uppercase tracking-widest text-slate-400 font-semibold">Account</span>
                                <span class="text-[13px] font-semibold text-slate-700">Chase Sapphire •••• 4242</span>
                            </div>
                            <div class="txn-review-row">
                                <span
                                    class="text-[10px] uppercase tracking-widest text-slate-400 font-semibold">Category</span>
                                <span
                                    class="text-[13px] font-semibold text-slate-700 bg-emerald-50 text-emerald-700 px-2 py-1 rounded">Groceries</span>
                            </div>
                            <div class="txn-review-row">
                                <span
                                    class="text-[10px] uppercase tracking-widest text-slate-400 font-semibold">Description</span>
                                <span class="text-[13px] font-semibold text-slate-700 text-right">Whole Foods
                                    Market</span>
                            </div>
                            <div class="txn-review-row">
                                <span
                                    class="text-[10px] uppercase tracking-widest text-slate-400 font-semibold">Budget</span>
                                <span class="text-[13px] font-semibold text-slate-700">Monthly Budget</span>
                            </div>
                            <div class="txn-review-row">
                                <span
                                    class="text-[10px] uppercase tracking-widest text-slate-400 font-semibold">Goal</span>
                                <span class="text-[13px] font-semibold text-slate-500 italic">-</span>
                            </div>
                        </div>
                    </div>

                    <!-- Quick Actions -->
                    <div class="flex gap-3">
                        <button onclick="closeModal('viewTransactionModal'); openModal('editTransactionModal')"
                            class="flex-1 flex items-center justify-center gap-2 px-4 py-2.5 bg-white border border-slate-200 rounded-lg text-xs font-semibold text-slate-700 hover:bg-slate-50 transition-colors">
                            <iconify-icon icon="solar:pen-linear" width="14"></iconify-icon>
                            Edit Transaction
                        </button>
                        <button onclick="closeModal('viewTransactionModal'); openModal('deleteTransactionModal')"
                            class="flex-1 flex items-center justify-center gap-2 px-4 py-2.5 bg-rose-50 border border-rose-200 rounded-lg text-xs font-semibold text-rose-700 hover:bg-rose-100 transition-colors">
                            <iconify-icon icon="solar:trash-bin-trash-linear" width="14"></iconify-icon>
                            Delete
                        </button>
                    </div>
                </div>
            </div>

            <!-- STEP 2: Analysis & Insights -->
            <div id="viewTxnStep2" class="setup-step hidden">
                <div class="space-y-6 txn-stagger">
                    <!-- Spending Analysis -->
                    <div>
                        <h3 class="text-[15px] font-bold text-slate-900 mb-3">Spending Analysis</h3>
                        <div class="grid grid-cols-2 gap-4">
                            <!-- Category Impact -->
                            <div class="bg-slate-50 rounded-lg p-4 border border-slate-100">
                                <div class="text-[10px] text-slate-500 mb-3">Category Impact</div>
                                <div class="h-20 flex items-end justify-center gap-1">
                                    <div class="w-3 bg-slate-300 h-2/3 rounded-t-sm"></div>
                                    <div class="w-3 bg-emerald-500 h-full rounded-t-sm"></div>
                                    <div class="w-3 bg-slate-300 h-1/2 rounded-t-sm"></div>
                                    <div class="w-3 bg-slate-300 h-3/4 rounded-t-sm"></div>
                                </div>
                                <div class="text-center mt-2">
                                    <div class="text-xs font-semibold text-slate-700">$86.42</div>
                                    <div class="text-[9px] text-slate-500">This month</div>
                                </div>
                            </div>
                            <!-- Budget Progress -->
                            <div class="bg-slate-50 rounded-lg p-4 border border-slate-100">
                                <div class="text-[10px] text-slate-500 mb-3">Budget Progress</div>
                                <div class="flex items-center justify-center h-20">
                                    <div class="relative">
                                        <div class="w-16 h-16 rounded-full border-4 border-slate-200"></div>
                                        <div
                                            class="absolute inset-0 w-16 h-16 rounded-full border-4 border-emerald-500 border-t-transparent rotate-45">
                                        </div>
                                        <div class="absolute inset-0 flex items-center justify-center">
                                            <span class="text-xs font-bold text-slate-700">68%</span>
                                        </div>
                                    </div>
                                </div>
                                <div class="text-center mt-2">
                                    <div class="text-xs font-semibold text-slate-700">$408.58</div>
                                    <div class="text-[9px] text-slate-500">remaining</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Related Transactions -->
                    <div>
                        <h3 class="text-[15px] font-bold text-slate-900 mb-3">Related Transactions</h3>
                        <div class="space-y-3">
                            <div
                                class="flex items-center justify-between p-3 bg-slate-50 rounded-lg border border-slate-100">
                                <div class="flex items-center gap-3">
                                    <div
                                        class="w-8 h-8 rounded-lg bg-white flex items-center justify-center text-slate-400 border border-slate-100">
                                        <iconify-icon icon="solar:cart-large-linear" width="14"></iconify-icon>
                                    </div>
                                    <div>
                                        <div class="text-sm font-semibold text-slate-900">Whole Foods</div>
                                        <div class="text-[10px] text-slate-400">Oct 18, 2023</div>
                                    </div>
                                </div>
                                <div class="text-sm font-bold text-slate-900">-$124.00</div>
                            </div>
                            <div
                                class="flex items-center justify-between p-3 bg-slate-50 rounded-lg border border-slate-100">
                                <div class="flex items-center gap-3">
                                    <div
                                        class="w-8 h-8 rounded-lg bg-white flex items-center justify-center text-slate-400 border border-slate-100">
                                        <iconify-icon icon="solar:cart-large-linear" width="14"></iconify-icon>
                                    </div>
                                    <div>
                                        <div class="text-sm font-semibold text-slate-900">Trader Joe's</div>
                                        <div class="text-[10px] text-slate-400">Oct 15, 2023</div>
                                    </div>
                                </div>
                                <div class="text-sm font-bold text-slate-900">-$45.50</div>
                            </div>
                            <div
                                class="flex items-center justify-between p-3 bg-slate-50 rounded-lg border border-slate-100">
                                <div class="flex items-center gap-3">
                                    <div
                                        class="w-8 h-8 rounded-lg bg-white flex items-center justify-center text-slate-400 border border-slate-100">
                                        <iconify-icon icon="solar:cart-large-linear" width="14"></iconify-icon>
                                    </div>
                                    <div>
                                        <div class="text-sm font-semibold text-slate-900">Whole Foods</div>
                                        <div class="text-[10px] text-slate-400">Oct 8, 2023</div>
                                    </div>
                                </div>
                                <div class="text-sm font-bold text-slate-900">-$67.89</div>
                            </div>
                        </div>
                    </div>

                    <!-- Monthly Trend -->
                    <div>
                        <h3 class="text-[15px] font-bold text-slate-900 mb-3">Monthly Trend</h3>
                        <div class="bg-slate-50 rounded-lg p-4 border border-slate-100">
                            <div class="flex justify-between text-[10px] text-slate-500 mb-2">
                                <span>October</span>
                                <span>+$323.81 vs avg</span>
                            </div>
                            <div class="h-16 flex items-end justify-between gap-1">
                                <div class="w-2 bg-slate-300 h-3/4 rounded-t-sm"></div>
                                <div class="w-2 bg-slate-300 h-1/2 rounded-t-sm"></div>
                                <div class="w-2 bg-slate-300 h-2/3 rounded-t-sm"></div>
                                <div class="w-2 bg-emerald-500 h-full rounded-t-sm"></div>
                                <div class="w-2 bg-slate-300 h-3/5 rounded-t-sm"></div>
                                <div class="w-2 bg-slate-300 h-1/3 rounded-t-sm"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

        </div>

        <!-- Footer -->
        <div class="modal-footer flex justify-between border-t border-slate-100">
            <button id="viewTxnBtnBack" onclick="viewTxnPreviousStep()" class="btn btn-secondary hidden">
                <iconify-icon icon="solar:arrow-left-linear" class="mr-1"></iconify-icon> Back
            </button>
            <div class="flex-1"></div>
            <button id="viewTxnBtnNext" onclick="viewTxnNextStep()" class="btn btn-primary"
                style="background:#10b981; box-shadow:none;">
                View Analysis <iconify-icon icon="solar:arrow-right-linear" class="ml-1"></iconify-icon>
            </button>
        </div>
    </div>
</div>

<!-- Edit Transaction Modal -->
<div id="editTransactionModal" class="modal-overlay" role="dialog" aria-modal="true"
    aria-labelledby="editTxnHeaderTitle">
    <div class="modal w-full mx-4 flex flex-col max-h-[90vh]">
        <!-- Header -->
        <div class="modal-header flex items-center justify-between border-b border-slate-100">
            <h3 class="text-xs font-bold text-slate-900 flex items-center gap-2 uppercase tracking-wider">
                <span id="editTxnHeaderTitle">Edit Transaction</span>
            </h3>
            <div class="flex items-center gap-3">
                <span id="editTxnStepText" class="text-[10px] text-slate-400 font-medium tracking-wide">Step 1 of
                    3</span>
                <button
                    class="w-7 h-7 rounded-lg flex items-center justify-center text-slate-300 hover:text-slate-600 hover:bg-slate-50 transition-all"
                    onclick="closeModal('editTransactionModal')" aria-label="Close">
                    <iconify-icon icon="solar:close-circle-linear" width="18"></iconify-icon>
                </button>
            </div>
        </div>

        <!-- Step Stepper -->
        <div class="txn-stepper" aria-label="Transaction edit progress">
            <div class="txn-step-wrap">
                <div class="txn-step-dot active" data-step="1" aria-current="step">1</div><span
                    class="txn-step-label active">Type</span>
            </div>
            <div class="txn-step-connector" data-connector="1"></div>
            <div class="txn-step-wrap">
                <div class="txn-step-dot" data-step="2">2</div><span class="txn-step-label">Details</span>
            </div>
            <div class="txn-step-connector" data-connector="2"></div>
            <div class="txn-step-wrap">
                <div class="txn-step-dot" data-step="3">3</div><span class="txn-step-label">Review</span>
            </div>
        </div>

        <!-- Main Body -->
        <div class="modal-body overflow-y-auto flex-1">

            <!-- STEP 1: Transaction Type -->
            <div id="editTxnStep1" class="setup-step txn-enter">
                <div class="mb-5">
                    <h2 class="text-[17px] font-bold text-slate-900 mb-1">Transaction Type</h2>
                    <p class="text-[11px] text-slate-500">Current type: <span id="currentTxnType"
                            class="font-semibold text-emerald-600">Expense</span></p>
                </div>
                <div class="grid grid-cols-1 gap-3 txn-stagger">
                    <div onclick="selectEditTxnType('expense')" id="editTxnTypeExpense" class="txn-card selected"
                        role="button" tabindex="0" onkeydown="if(event.key==='Enter')selectEditTxnType('expense')">
                        <div class="flex items-start gap-4">
                            <div class="txn-icon"><iconify-icon icon="solar:minus-circle-linear"
                                    width="18"></iconify-icon></div>
                            <div class="flex-1 min-w-0">
                                <h3 class="text-[13px] font-bold text-slate-900 mb-0.5">Expense</h3>
                                <p class="text-[11px] text-slate-500 leading-relaxed">Money spent on goods, services, or
                                    bills.</p>
                            </div>
                            <div class="txn-check"><iconify-icon icon="solar:check-read-linear"
                                    width="10"></iconify-icon></div>
                        </div>
                    </div>
                    <div onclick="selectEditTxnType('income')" id="editTxnTypeIncome" class="txn-card" role="button"
                        tabindex="0" onkeydown="if(event.key==='Enter')selectEditTxnType('income')">
                        <div class="flex items-start gap-4">
                            <div class="txn-icon"><iconify-icon icon="solar:add-circle-linear"
                                    width="18"></iconify-icon></div>
                            <div class="flex-1 min-w-0">
                                <h3 class="text-[13px] font-bold text-slate-900 mb-0.5">Income</h3>
                                <p class="text-[11px] text-slate-500 leading-relaxed">Money received from salary,
                                    investments, or other sources.</p>
                            </div>
                            <div class="txn-check"><iconify-icon icon="solar:check-read-linear"
                                    width="10"></iconify-icon></div>
                        </div>
                    </div>
                    <div onclick="selectEditTxnType('contribution')" id="editTxnTypeContribution" class="txn-card"
                        role="button" tabindex="0" onkeydown="if(event.key==='Enter')selectEditTxnType('contribution')">
                        <div class="flex items-start gap-4">
                            <div class="txn-icon"><iconify-icon icon="solar:flag-linear" width="18"></iconify-icon>
                            </div>
                            <div class="flex-1 min-w-0">
                                <h3 class="text-[13px] font-bold text-slate-900 mb-0.5">Contribution</h3>
                                <p class="text-[11px] text-slate-500 leading-relaxed">Money allocated to savings goals
                                    or investments.</p>
                            </div>
                            <div class="txn-check"><iconify-icon icon="solar:check-read-linear"
                                    width="10"></iconify-icon></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- STEP 2: Transaction Details -->
            <div id="editTxnStep2" class="setup-step hidden">
                <div class="mb-5">
                    <h2 class="text-[17px] font-bold text-slate-900 mb-1 flex items-center gap-2.5">
                        <div class="txn-icon" style="width:30px;height:30px;border-radius:8px;"><iconify-icon
                                icon="solar:pen-new-square-linear" width="14"></iconify-icon></div>
                        Transaction Details
                    </h2>
                </div>
                <div class="space-y-5 txn-stagger">
                    <div>
                        <label class="txn-label" for="editTxnAmount">Amount <span
                                class="text-slate-400">*</span></label>
                        <div class="relative">
                            <span
                                class="absolute left-3.5 top-1/2 -translate-y-1/2 text-slate-400 font-semibold text-xs">$</span>
                            <input type="number" id="editTxnAmount" step="0.01" value="86.42" class="txn-input pl-7"
                                placeholder="0.00" required>
                        </div>
                    </div>
                    <div>
                        <label class="txn-label" for="editTxnDate">Date <span class="text-slate-400">*</span></label>
                        <input type="date" id="editTxnDate" class="txn-input" value="2023-10-24" required>
                    </div>
                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label class="txn-label" for="editTxnCategory">Category</label>
                            <select id="editTxnCategory" class="txn-input">
                                <option value="">Select category...</option>
                                <option value="groceries" selected>Groceries</option>
                                <option value="transport">Transport</option>
                                <option value="entertainment">Entertainment</option>
                                <option value="utilities">Utilities</option>
                                <option value="salary">Salary</option>
                                <option value="other">Other</option>
                            </select>
                        </div>
                        <div>
                            <label class="txn-label" for="editTnxBudget">Budget</label>
                            <select id="editTnxBudget" class="txn-input">
                                <option value="">No budget</option>
                                <option value="monthly" selected>Monthly Budget</option>
                                <option value="holiday">Holiday Trip</option>
                            </select>
                        </div>
                    </div>
                    <div>
                        <label class="txn-label" for="editTxnGoal">Goal Contribution</label>
                        <div class="relative">
                            <iconify-icon icon="solar:target-linear"
                                class="absolute left-3.5 top-1/2 -translate-y-1/2 text-slate-400"
                                width="14"></iconify-icon>
                            <select id="editTxnGoal" class="txn-input pl-9">
                                <option value="" selected>No Goal</option>
                                <option value="emergency">Emergency Fund (50%)</option>
                                <option value="car">New Car (20%)</option>
                            </select>
                        </div>
                    </div>
                    <div>
                        <label class="txn-label" for="editTxnAccount">Account <span
                                class="text-slate-400">*</span></label>
                        <select id="editTxnAccount" class="txn-input" required>
                            <option value="">Select account...</option>
                            <option value="chase" selected>Chase Sapphire</option>
                            <option value="checking">Checking</option>
                            <option value="savings">Savings</option>
                        </select>
                    </div>
                    <div>
                        <label class="txn-label" for="editTxnDescription">Description <span
                                class="text-slate-400 font-normal lowercase"
                                style="letter-spacing:0">(optional)</span></label>
                        <textarea id="editTxnDescription" rows="2" class="txn-input resize-none"
                            placeholder="What was this transaction for?">Whole Foods Market</textarea>
                    </div>
                </div>
            </div>

            <!-- STEP 3: Review Changes -->
            <div id="editTxnStep3" class="setup-step hidden">
                <div class="mb-5">
                    <h2 class="text-[17px] font-bold text-slate-900 mb-1 flex items-center gap-2.5">
                        <div class="txn-icon" style="width:30px;height:30px;border-radius:8px;"><iconify-icon
                                icon="solar:clipboard-check-linear" width="14"></iconify-icon></div>
                        Review & Confirm
                    </h2>
                </div>
                <div class="space-y-4 txn-stagger">
                    <div class="txn-amount-display">
                        <div class="text-xs text-slate-500 uppercase tracking-wide mb-1">Updated Amount</div>
                        <div id="editReviewAmount" class="txn-amount-value expense">-$86.42</div>
                        <div id="editReviewType"
                            class="text-xs font-semibold px-2 py-1 rounded bg-slate-100 text-slate-500 uppercase tracking-wider inline-block mt-2">
                            Expense</div>
                    </div>
                    <div class="txn-review">
                        <div class="txn-review-body">
                            <div class="txn-review-row">
                                <span
                                    class="text-[10px] uppercase tracking-widest text-slate-400 font-semibold">Date</span>
                                <span id="editReviewDate" class="text-[13px] font-semibold text-slate-700">Oct 24,
                                    2023</span>
                            </div>
                            <div class="txn-review-row">
                                <span
                                    class="text-[10px] uppercase tracking-widest text-slate-400 font-semibold">Category</span>
                                <span id="editReviewCategory"
                                    class="text-[13px] font-semibold text-slate-700">Groceries</span>
                            </div>
                            <div class="txn-review-row">
                                <span
                                    class="text-[10px] uppercase tracking-widest text-slate-400 font-semibold">Account</span>
                                <span id="editReviewAccount" class="text-[13px] font-semibold text-slate-700">Chase
                                    Sapphire</span>
                            </div>
                            <div class="txn-review-row">
                                <span
                                    class="text-[10px] uppercase tracking-widest text-slate-400 font-semibold">Goal</span>
                                <span id="editReviewGoal" class="text-[13px] font-semibold text-slate-700">-</span>
                            </div>
                            <div class="txn-review-row">
                                <span
                                    class="text-[10px] uppercase tracking-widest text-slate-400 font-semibold">Description</span>
                                <span id="editReviewDescription"
                                    class="text-[11px] text-slate-500 italic max-w-[180px] text-right">Whole Foods
                                    Market</span>
                            </div>
                        </div>
                    </div>
                    <div class="txn-notice success">
                        <iconify-icon icon="solar:check-circle-linear" width="16"
                            class="flex-shrink-0 mt-px"></iconify-icon>
                        <div>
                            <h4 class="font-bold text-[10px] uppercase tracking-widest mb-0.5">Changes Summary</h4>
                            <p class="text-[11px] leading-relaxed" style="opacity:0.85">Review your changes before
                                saving. The transaction will be updated immediately.</p>
                        </div>
                    </div>
                </div>
            </div>

        </div>

        <!-- Footer -->
        <div class="modal-footer flex justify-between border-t border-slate-100">
            <button id="editTxnBtnBack" onclick="editTxnPreviousStep()" class="btn btn-secondary hidden">
                <iconify-icon icon="solar:arrow-left-linear" class="mr-1"></iconify-icon> Back
            </button>
            <div class="flex-1"></div>
            <button id="editTxnBtnNext" onclick="editTxnNextStep()" class="btn btn-primary"
                style="background:#10b981; box-shadow:none;">
                Continue <iconify-icon icon="solar:arrow-right-linear" class="ml-1"></iconify-icon>
            </button>
        </div>
    </div>
</div>

<!-- Delete Confirmation Modal -->
<div id="deleteTransactionModal" class="modal-overlay" role="dialog" aria-modal="true"
    aria-labelledby="deleteTxnHeaderTitle">
    <div class="modal w-full mx-4 max-w-md flex flex-col">
        <!-- Header -->
        <div class="modal-header flex items-center justify-between border-b border-slate-100">
            <h3 class="text-xs font-bold text-slate-900 flex items-center gap-2 uppercase tracking-wider">
                <span id="deleteTxnHeaderTitle">Delete Transaction</span>
            </h3>
            <button
                class="w-7 h-7 rounded-lg flex items-center justify-center text-slate-300 hover:text-slate-600 hover:bg-slate-50 transition-all"
                onclick="closeModal('deleteTransactionModal')" aria-label="Close">
                <iconify-icon icon="solar:close-circle-linear" width="18"></iconify-icon>
            </button>
        </div>

        <!-- Main Body -->
        <div class="modal-body overflow-y-auto flex-1 py-8">
            <div class="text-center txn-enter">
                <!-- Warning Icon -->
                <div
                    class="w-16 h-16 rounded-full bg-rose-50 text-rose-500 flex items-center justify-center mx-auto mb-6">
                    <iconify-icon icon="solar:trash-bin-trash-bold" width="28"></iconify-icon>
                </div>

                <!-- Warning Message -->
                <h2 class="text-lg font-bold text-slate-900 mb-3">Delete Transaction?</h2>
                <p class="text-sm text-slate-500 mb-6 max-w-xs mx-auto leading-relaxed">
                    Are you sure you want to delete this transaction? This action cannot be undone and will permanently
                    remove the transaction from your records.
                </p>

                <!-- Transaction Details -->
                <div class="txn-review mx-auto max-w-sm">
                    <div class="txn-review-body">
                        <div class="txn-review-row">
                            <span
                                class="text-[10px] uppercase tracking-widest text-slate-400 font-semibold">Amount</span>
                            <span class="text-sm font-bold text-slate-900">-$86.42</span>
                        </div>
                        <div class="txn-review-row">
                            <span
                                class="text-[10px] uppercase tracking-widest text-slate-400 font-semibold">Description</span>
                            <span class="text-sm font-semibold text-slate-700">Whole Foods Market</span>
                        </div>
                        <div class="txn-review-row">
                            <span class="text-[10px] uppercase tracking-widest text-slate-400 font-semibold">Date</span>
                            <span class="text-sm font-semibold text-slate-700">Oct 24, 2023</span>
                        </div>
                    </div>
                </div>

                <!-- Final Warning -->
                <div class="txn-notice warn mx-auto max-w-sm mt-6">
                    <iconify-icon icon="solar:danger-triangle-linear" width="16"
                        class="flex-shrink-0 mt-px"></iconify-icon>
                    <div>
                        <h4 class="font-bold text-[10px] uppercase tracking-widest mb-0.5">Irreversible Action</h4>
                        <p class="text-[11px] leading-relaxed" style="opacity:0.85">This transaction will be permanently
                            deleted and cannot be recovered.</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <div class="modal-footer flex justify-between border-t border-slate-100 px-6 py-4">
            <button onclick="closeModal('deleteTransactionModal')"
                class="flex-1 flex items-center justify-center gap-2 px-4 py-2.5 bg-white border border-slate-200 rounded-lg text-xs font-semibold text-slate-700 hover:bg-slate-50 transition-colors">
                <iconify-icon icon="solar:close-circle-linear" width="14"></iconify-icon>
                Cancel
            </button>
            <button onclick="closeModal('deleteTransactionModal')"
                class="flex-1 flex items-center justify-center gap-2 px-4 py-2.5 bg-rose-600 border border-rose-600 rounded-lg text-xs font-semibold text-white hover:bg-rose-700 transition-colors ml-3">
                <iconify-icon icon="solar:trash-bin-trash-linear" width="14"></iconify-icon>
                Delete Transaction
            </button>
        </div>
    </div>
</div>

<script>
    // ========================================
    // Add Transaction Modal — Stepper Logic
    // ========================================
    (function () {
        let addTxnStep = 1;
        let addTxnSelectedType = '';

        window.selectTxnType = function (type) {
            addTxnSelectedType = type;
            // Remove selected from all cards
            document.querySelectorAll('#addTxnStep1 .txn-card').forEach(c => c.classList.remove('selected'));
            // Add selected to clicked card
            const cardId = 'txnType' + type.charAt(0).toUpperCase() + type.slice(1);
            const card = document.getElementById(cardId);
            if (card) card.classList.add('selected');
            // Enable continue button
            const btn = document.getElementById('addTxnBtnNext');
            if (btn) btn.disabled = false;
        };

        window.addTxnNextStep = function () {
            if (addTxnStep >= 3) {
                // Submit — close modal
                closeModal('addTransactionModal');
                addTxnReset();
                return;
            }
            addTxnStep++;
            addTxnUpdateUI();
        };

        window.addTxnPreviousStep = function () {
            if (addTxnStep <= 1) return;
            addTxnStep--;
            addTxnUpdateUI();
        };

        function addTxnUpdateUI() {
            // Show/hide steps
            for (let i = 1; i <= 3; i++) {
                const el = document.getElementById('addTxnStep' + i);
                if (el) {
                    el.classList.toggle('hidden', i !== addTxnStep);
                    if (i === addTxnStep) {
                        el.classList.remove('hidden');
                        el.classList.add('txn-enter');
                    }
                }
            }

            // Update stepper dots
            const modal = document.getElementById('addTransactionModal');
            if (modal) {
                modal.querySelectorAll('.txn-step-dot').forEach(dot => {
                    const step = parseInt(dot.dataset.step);
                    dot.classList.remove('active', 'completed');
                    if (step === addTxnStep) dot.classList.add('active');
                    else if (step < addTxnStep) dot.classList.add('completed');
                });
                modal.querySelectorAll('.txn-step-label').forEach((label, idx) => {
                    const step = idx + 1;
                    label.classList.remove('active', 'completed');
                    if (step === addTxnStep) label.classList.add('active');
                    else if (step < addTxnStep) label.classList.add('completed');
                });
                modal.querySelectorAll('.txn-step-connector').forEach(conn => {
                    const connStep = parseInt(conn.dataset.connector);
                    conn.classList.toggle('completed', connStep < addTxnStep);
                });
            }

            // Update header step text
            const stepText = document.getElementById('addTxnStepText');
            if (stepText) stepText.textContent = 'Step ' + addTxnStep + ' of 3';

            // Show/hide back button
            const backBtn = document.getElementById('addTxnBtnBack');
            if (backBtn) backBtn.classList.toggle('hidden', addTxnStep === 1);

            // Update next button text
            const nextBtn = document.getElementById('addTxnBtnNext');
            if (nextBtn) {
                if (addTxnStep === 3) {
                    nextBtn.innerHTML = 'Add Transaction <iconify-icon icon="solar:check-read-linear" class="ml-1"></iconify-icon>';
                } else {
                    nextBtn.innerHTML = 'Continue <iconify-icon icon="solar:arrow-right-linear" class="ml-1"></iconify-icon>';
                }
                // Enable next on step 2+ (step 1 requires selection)
                if (addTxnStep > 1) nextBtn.disabled = false;
            }

            // Populate review step
            if (addTxnStep === 3) {
                const amount = document.getElementById('txnAmount')?.value || '0.00';
                const date = document.getElementById('txnDate')?.value || '-';
                const category = document.getElementById('txnCategory');
                const account = document.getElementById('txnAccount');
                const goal = document.getElementById('txnGoal');
                const description = document.getElementById('txnDescription')?.value || '';

                const reviewAmount = document.getElementById('reviewAmount');
                if (reviewAmount) {
                    reviewAmount.textContent = '$' + parseFloat(amount || 0).toFixed(2);
                    reviewAmount.className = 'txn-amount-value ' + (addTxnSelectedType === 'income' ? 'income' : 'expense');
                }
                const reviewType = document.getElementById('reviewType');
                if (reviewType) reviewType.textContent = addTxnSelectedType.charAt(0).toUpperCase() + addTxnSelectedType.slice(1);

                const reviewDate = document.getElementById('reviewDate');
                if (reviewDate) reviewDate.textContent = date ? new Date(date + 'T00:00:00').toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' }) : '-';

                const reviewCategory = document.getElementById('reviewCategory');
                if (reviewCategory) reviewCategory.textContent = category?.selectedOptions[0]?.text || '-';

                const reviewAccount = document.getElementById('reviewAccount');
                if (reviewAccount) reviewAccount.textContent = account?.selectedOptions[0]?.text || '-';

                const reviewGoal = document.getElementById('reviewGoal');
                if (reviewGoal) reviewGoal.textContent = goal?.selectedOptions[0]?.text || '-';

                const reviewDescription = document.getElementById('reviewDescription');
                if (reviewDescription) reviewDescription.textContent = description || 'No description provided.';
            }
        }

        function addTxnReset() {
            addTxnStep = 1;
            addTxnSelectedType = '';
            // Reset card selections
            document.querySelectorAll('#addTxnStep1 .txn-card').forEach(c => c.classList.remove('selected'));
            // Reset form fields
            const amount = document.getElementById('txnAmount'); if (amount) amount.value = '';
            const date = document.getElementById('txnDate'); if (date) date.value = '';
            const category = document.getElementById('txnCategory'); if (category) category.selectedIndex = 0;
            const budget = document.getElementById('tnxBudget'); if (budget) budget.selectedIndex = 0;
            const goal = document.getElementById('txnGoal'); if (goal) goal.selectedIndex = 0;
            const account = document.getElementById('txnAccount'); if (account) account.selectedIndex = 0;
            const desc = document.getElementById('txnDescription'); if (desc) desc.value = '';
            // Reset UI
            addTxnUpdateUI();
            const btn = document.getElementById('addTxnBtnNext');
            if (btn) btn.disabled = true;
        }

        // Reset when modal is closed via overlay click
        const addModal = document.getElementById('addTransactionModal');
        if (addModal) {
            const observer = new MutationObserver(() => {
                if (!addModal.classList.contains('open')) addTxnReset();
            });
            observer.observe(addModal, { attributes: true, attributeFilter: ['class'] });
        }

        // ========================================
        // Edit Transaction Modal — Stepper Logic
        // ========================================
        let editTxnStep = 1;
        let editTxnSelectedType = 'expense'; // default pre-selected

        window.selectEditTxnType = function (type) {
            editTxnSelectedType = type;
            document.querySelectorAll('#editTxnStep1 .txn-card').forEach(c => c.classList.remove('selected'));
            const cardId = 'editTxnType' + type.charAt(0).toUpperCase() + type.slice(1);
            const card = document.getElementById(cardId);
            if (card) card.classList.add('selected');
            const currentType = document.getElementById('currentTxnType');
            if (currentType) {
                currentType.textContent = type.charAt(0).toUpperCase() + type.slice(1);
            }
        };

        window.editTxnNextStep = function () {
            if (editTxnStep >= 3) {
                closeModal('editTransactionModal');
                editTxnReset();
                return;
            }
            editTxnStep++;
            editTxnUpdateUI();
        };

        window.editTxnPreviousStep = function () {
            if (editTxnStep <= 1) return;
            editTxnStep--;
            editTxnUpdateUI();
        };

        function editTxnUpdateUI() {
            for (let i = 1; i <= 3; i++) {
                const el = document.getElementById('editTxnStep' + i);
                if (el) {
                    el.classList.toggle('hidden', i !== editTxnStep);
                    if (i === editTxnStep) {
                        el.classList.remove('hidden');
                        el.classList.add('txn-enter');
                    }
                }
            }

            const modal = document.getElementById('editTransactionModal');
            if (modal) {
                modal.querySelectorAll('.txn-step-dot').forEach(dot => {
                    const step = parseInt(dot.dataset.step);
                    dot.classList.remove('active', 'completed');
                    if (step === editTxnStep) dot.classList.add('active');
                    else if (step < editTxnStep) dot.classList.add('completed');
                });
                modal.querySelectorAll('.txn-step-label').forEach((label, idx) => {
                    const step = idx + 1;
                    label.classList.remove('active', 'completed');
                    if (step === editTxnStep) label.classList.add('active');
                    else if (step < editTxnStep) label.classList.add('completed');
                });
                modal.querySelectorAll('.txn-step-connector').forEach(conn => {
                    const connStep = parseInt(conn.dataset.connector);
                    conn.classList.toggle('completed', connStep < editTxnStep);
                });
            }

            const stepText = document.getElementById('editTxnStepText');
            if (stepText) stepText.textContent = 'Step ' + editTxnStep + ' of 3';

            const backBtn = document.getElementById('editTxnBtnBack');
            if (backBtn) backBtn.classList.toggle('hidden', editTxnStep === 1);

            const nextBtn = document.getElementById('editTxnBtnNext');
            if (nextBtn) {
                if (editTxnStep === 3) {
                    nextBtn.innerHTML = 'Save Changes <iconify-icon icon="solar:check-read-linear" class="ml-1"></iconify-icon>';
                } else {
                    nextBtn.innerHTML = 'Continue <iconify-icon icon="solar:arrow-right-linear" class="ml-1"></iconify-icon>';
                }
            }

            // Populate edit review step
            if (editTxnStep === 3) {
                const amount = document.getElementById('editTxnAmount')?.value || '86.42';
                const date = document.getElementById('editTxnDate')?.value || '2023-10-24';
                const category = document.getElementById('editTxnCategory');
                const account = document.getElementById('editTxnAccount');
                const goal = document.getElementById('editTxnGoal');
                const description = document.getElementById('editTxnDescription')?.value || '';

                const reviewAmount = document.getElementById('editReviewAmount');
                if (reviewAmount) {
                    const prefix = editTxnSelectedType === 'income' ? '+' : '-';
                    reviewAmount.textContent = prefix + '$' + parseFloat(amount || 0).toFixed(2);
                    reviewAmount.className = 'txn-amount-value ' + (editTxnSelectedType === 'income' ? 'income' : 'expense');
                }
                const reviewType = document.getElementById('editReviewType');
                if (reviewType) reviewType.textContent = editTxnSelectedType.charAt(0).toUpperCase() + editTxnSelectedType.slice(1);

                const reviewDate = document.getElementById('editReviewDate');
                if (reviewDate) reviewDate.textContent = date ? new Date(date + 'T00:00:00').toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' }) : '-';

                const reviewCategory = document.getElementById('editReviewCategory');
                if (reviewCategory) reviewCategory.textContent = category?.selectedOptions[0]?.text || '-';

                const reviewAccount = document.getElementById('editReviewAccount');
                if (reviewAccount) reviewAccount.textContent = account?.selectedOptions[0]?.text || '-';

                const reviewGoal = document.getElementById('editReviewGoal');
                if (reviewGoal) reviewGoal.textContent = goal?.selectedOptions[0]?.text || '-';

                const reviewDescription = document.getElementById('editReviewDescription');
                if (reviewDescription) reviewDescription.textContent = description || 'No description provided.';
            }
        }

        function editTxnReset() {
            editTxnStep = 1;
            editTxnSelectedType = 'expense';
            editTxnUpdateUI();
            // Re-select the default type
            document.querySelectorAll('#editTxnStep1 .txn-card').forEach(c => c.classList.remove('selected'));
            const defaultCard = document.getElementById('editTxnTypeExpense');
            if (defaultCard) defaultCard.classList.add('selected');
        }

        const editModal = document.getElementById('editTransactionModal');
        if (editModal) {
            const observer = new MutationObserver(() => {
                if (!editModal.classList.contains('open')) editTxnReset();
            });
            observer.observe(editModal, { attributes: true, attributeFilter: ['class'] });
        }

        // ========================================
        // View Transaction Modal — Stepper Logic
        // ========================================
        let viewTxnStep = 1;

        window.viewTxnNextStep = function () {
            if (viewTxnStep >= 2) return;
            viewTxnStep++;
            viewTxnUpdateUI();
        };

        window.viewTxnPreviousStep = function () {
            if (viewTxnStep <= 1) return;
            viewTxnStep--;
            viewTxnUpdateUI();
        };

        function viewTxnUpdateUI() {
            for (let i = 1; i <= 2; i++) {
                const el = document.getElementById('viewTxnStep' + i);
                if (el) {
                    el.classList.toggle('hidden', i !== viewTxnStep);
                    if (i === viewTxnStep) {
                        el.classList.remove('hidden');
                        el.classList.add('txn-enter');
                    }
                }
            }

            const modal = document.getElementById('viewTransactionModal');
            if (modal) {
                modal.querySelectorAll('.txn-step-dot').forEach(dot => {
                    const step = parseInt(dot.dataset.step);
                    dot.classList.remove('active', 'completed');
                    if (step === viewTxnStep) dot.classList.add('active');
                    else if (step < viewTxnStep) dot.classList.add('completed');
                });
                modal.querySelectorAll('.txn-step-label').forEach((label, idx) => {
                    const step = idx + 1;
                    label.classList.remove('active', 'completed');
                    if (step === viewTxnStep) label.classList.add('active');
                    else if (step < viewTxnStep) label.classList.add('completed');
                });
                modal.querySelectorAll('.txn-step-connector').forEach(conn => {
                    const connStep = parseInt(conn.dataset.connector);
                    conn.classList.toggle('completed', connStep < viewTxnStep);
                });
            }

            const stepText = document.getElementById('viewTxnStepText');
            if (stepText) stepText.textContent = 'Step ' + viewTxnStep + ' of 2';

            const backBtn = document.getElementById('viewTxnBtnBack');
            if (backBtn) backBtn.classList.toggle('hidden', viewTxnStep === 1);

            const nextBtn = document.getElementById('viewTxnBtnNext');
            if (nextBtn) {
                if (viewTxnStep === 2) {
                    nextBtn.innerHTML = 'Back to Overview <iconify-icon icon="solar:arrow-left-linear" class="ml-1"></iconify-icon>';
                    nextBtn.onclick = function () { viewTxnStep = 1; viewTxnUpdateUI(); };
                } else {
                    nextBtn.innerHTML = 'View Analysis <iconify-icon icon="solar:arrow-right-linear" class="ml-1"></iconify-icon>';
                    nextBtn.onclick = viewTxnNextStep;
                }
            }
        }

        function viewTxnReset() {
            viewTxnStep = 1;
            viewTxnUpdateUI();
        }

        const viewModal = document.getElementById('viewTransactionModal');
        if (viewModal) {
            const observer = new MutationObserver(() => {
                if (!viewModal.classList.contains('open')) viewTxnReset();
            });
            observer.observe(viewModal, { attributes: true, attributeFilter: ['class'] });
        }
    })();
</script>